<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LP Studios | Detalle del Producto</title>

  <!-- ===== Bootstrap ===== -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <!-- ===== Estilos locales ===== -->
  <link rel="stylesheet" href="/assets/stylesheets/fearless.css">
</head>

<body class="bg-dark text-light">

  <!-- ===== NAVBAR ===== -->
  <nav class="navbar navbar-dark bg-dark border-bottom shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-semibold" href="/">LP Studios</a>
      <div class="ms-auto d-flex gap-2">
        <a class="btn btn-outline-light btn-sm" href="/shop">
          🛍️ Tienda
        </a>
        <!-- NAVBAR_PLACEHOLDER -->
      </div>
    </div>
  </nav>

  <!-- ===== MAIN CONTENT ===== -->
  <main class="container py-5">

    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/" class="text-white text-decoration-none">Inicio</a></li>
        <li class="breadcrumb-item"><a href="/shop" class="text-white text-decoration-none">Tienda</a></li>
        <li class="breadcrumb-item active text-light" aria-current="page">Detalle del Producto</li>
      </ol>
    </nav>

    <!-- ===== PRODUCT DETAIL ===== -->
    <div class="row g-5 align-items-start">
      <!-- Previsualización principal -->
      <div class="col-12 col-lg-7">
        <!-- MEDIA_PREVIEW_PLACEHOLDER -->
      </div>

      <!-- Información del producto -->
      <div class="col-12 col-lg-5">
        <h1 class="fw-bold mb-3">🎵 Nombre del Producto</h1>
        <p class="text-muted mb-3">
          Descripción detallada del producto. Aquí puedes incluir características, inspiración o información del autor.
        </p>

        <p class="mb-2">
          <span class="me-3">⭐ <strong>4.5</strong> / 5</span>
          <span class="me-3">📥 <strong>152</strong> descargas</span>
          <span class="badge bg-info text-dark">Categoría: Música</span>
        </p>

        <hr class="border-secondary my-3">

        <h3 class="text-success fw-semibold mb-4">$99.99</h3>

        <!-- CTA_PLACEHOLDER -->

        <a href="/shop" class="btn btn-outline-light w-100">
          <i class="bi bi-arrow-left me-2"></i>Volver a la Tienda
        </a>
      </div>
    </div>
  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="text-center text-muted py-4 mt-5 border-top">
    <small>© 2025 LP Studios — Fearless Design. Timeless Sound.</small>
  </footer>

  <!-- ===== GIFT MODAL ===== -->
  <div class="modal fade" id="giftModal" tabindex="-1" aria-labelledby="giftModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content bg-dark text-light border-secondary">
        <div class="modal-header border-secondary">
          <h5 class="modal-title" id="giftModalLabel">🎁 Enviar como regalo</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p class="small text-muted">Vas a regalar <strong data-gift-title>este contenido</strong>.</p>
          <div class="alert alert-info d-none" data-gift-feedback></div>
          <form id="gift-form">
            <input type="hidden" name="mediaId">
            <div class="mb-3">
              <label class="form-label">Correo del destinatario</label>
              <input type="email" name="email" class="form-control" list="gift-recipient-suggestions" placeholder="ej: amigo@correo.com" required>
              <datalist id="gift-recipient-suggestions"></datalist>
              <small class="text-muted">Escribe al menos 2 letras para buscar.</small>
            </div>
            <div class="mb-3">
              <label class="form-label">Mensaje (opcional)</label>
              <textarea name="message" class="form-control" rows="2" placeholder="Añade una nota para tu amigo"></textarea>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-warning">
                <i class="bi bi-gift me-1"></i>Enviar regalo
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== SCRIPTS ===== -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    async function addToCart(productId) {
      try {
        const response = await fetch('/cart/add', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: `mediaId=${productId}`,
          redirect: 'follow'
        });
        
        if (response.ok || response.redirected) {
          alert(`✅ Producto agregado al carrito`);
          // NO redirigir automáticamente - el usuario puede seguir navegando
        } else {
          alert(`❌ Error al agregar al carrito`);
        }
      } catch (error) {
        console.error('Error:', error);
        alert(`❌ Error al agregar al carrito`);
      }
    }
  </script>
  <script src="/assets/javascripts/gifting.js"></script>
</body>
</html>
